<div class="container g-mt-100">
  <div class="u-heading-v1-5 g-bg-main g-brd-blue g-mb-20 text-center g-py-50">
    <h1 class="h3 u-heading-v1__title">Import orders</h1>
  </div>
  <div class="row">
    <div class="col-md-12 text-right">
      <a href='assets/sample/ctordering_orders.xlsx' class='btn btn-md u-btn-outline-pink u-btn-hover-v1-2 g-font-weight-600 g-letter-spacing-0_5 text-uppercase g-brd-2 g-rounded-10 g-mr-10 g-mb-15'>
        <i class="fa fa-file-excel-o g-mr-5"></i>Download Sample
      </a>
    </div>
  </div>
  <div class="u-shadow-v3 g-bg-white g-brd-around g-brd-gray-light-v4 g-line-height-2 g-pa-40" role="alert">
    <!-- Text Input -->
    <div class="row">
      <div class="form-group g-mb-25 col-md-6">
        <input type="file" style="display: inline-block;" (change)="incomingfile($event)" placeholder="Upload file" accept=".xlsx">
      </div>
      <div class="form-group g-mb-25 col-md-6">
        <button (click)="upload()" class="btn btn-md u-btn-outline-cyan g-mr-10 g-mb-15" type="submit">
          <span *ngIf="!isOrderImporting">Import Order</span>
          <span *ngIf="isOrderImporting">Importing Order...</span>
          <span class="g-pl-5" *ngIf="isOrderImporting">
            <i class="fa fa-spinner fa-spin"></i>
            <span class="sr-only">Loading...</span>
          </span>
        </button>
        <button class="btn btn-md u-btn-outline-bluegray g-mr-10 g-mb-15" type="button" (click)="cancelImportOrder()">
          Cancel
        </button>
      </div>
    </div>
  </div>
  <div class="g-bg-main g-brd-blue g-mb-20 text-center g-py-50" *ngIf="imported_orders && !isOrderImporting">
    <div class="table-responsive">
      <table class="table table-bordered u-table--v2">
        <thead class="text-uppercase g-letter-spacing-1">
          <tr>
            <th class="align-middle g-color-black">#</th>
            <th class="align-middle g-color-black">Scheduled Order Time</th>
            <th class="align-middle g-color-black">Reference</th>
            <th class="align-middle g-color-black">Station</th>
            <th class="align-middle g-color-black">Is Company Order</th>
            <th class="align-middle g-color-black">Account</th>
            <th class="align-middle g-color-black">Total Value</th>
            <th class="align-middle g-color-black">Item</th>
            <th class="align-middle g-color-black">Notes</th>
            <th class="align-middle g-color-black">Quantity</th>
            <th class="align-middle g-color-black">Value</th>
            <th class="align-middle g-color-black">Success</th>
            <th class="align-middle g-color-black">Error</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let order of imported_orders">
            <td class="align-middle">{{order.order_id}}</td>
            <td class="align-middle">{{order.scheduled_order_time}}</td>
            <td class="align-middle">{{order.customer_name}}</td>
            <td class="align-middle">{{order.station?.name}}</td>
            <td class="align-middle">{{order.charge_to_account}}</td>
            <td class="align-middle">{{order.account?.name}}</td>
            <td class="align-middle">{{order.total_value}}</td>
            <td class="align-middle">{{order.item}}</td>
            <td class="align-middle">{{order.notes}}</td>
            <td class="align-middle">{{order.quantity}}</td>
            <td class="align-middle">{{order.value}}</td>
            <td class="align-middle">{{order.success}}</td>
            <td class="align-middle">{{order.error}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="row" *ngIf="isOrderImporting">
      <div class="col-md-12 text-center g-color-blue">
        <i class="fa fa-spinner fa-spin"></i>
        <span class="sr-only">Loading...</span>
        <p>Loading orders...</p>
      </div>
    </div>
  </div>
</div>